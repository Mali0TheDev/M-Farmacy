<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="assets/images/Favorite_Icon.png">
    <link rel="stylesheet" href="contact.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <title>M-Farmacy | تواصل معنا</title>
</head>
<body>

    <header class="main-header">
        <div class="container">
            <nav class="nav-left">
                <a href="index.html" class="nav-link">الرئيسية</a> 
                <a href="about_us.html" class="nav-link">من نحن</a>
                <a href="blog.html" class="nav-link">المدونة</a>
                <a href="products.html" class="nav-link">المنتجات</a>
                <a href="contact.html" class="nav-link active">اتصل بنا</a>
            </nav>

            <div class="nav-middle">
                <a href="index.html">
                    <img src="assets/images/Logo.png" alt="Logo" class="header-logo">
                </a>
            </div>

            <div class="nav-right">
                <div class="search-bar">
                    <i class="fa-solid fa-magnifying-glass"></i>
                    <input type="text" placeholder="بحث ...">
                </div>
                
                <div class="icon-group desktop-only">
                    <a href="#" class="login-link">
                        <i class="fa-regular fa-user"></i>
                        <span>تسجيل الدخول</span>
                    </a>
                    <a href="#" class="icon-link">
                        <i class="fa-solid fa-gift"></i>
                    </a>
                    <a href="#" class="cart-icon">
                        <i class="fa-solid fa-bag-shopping"></i>
                    </a>
                </div>
            </div>

            <div class="menu-toggle" id="mobile-menu-btn">
                <i class="fa-solid fa-bars"></i>
            </div>
        </div>
    </header>

    <aside class="mobile-sidebar" id="sidebar">
        <div class="close-menu" id="close-btn">&times;</div>
        
        <div class="sidebar-section">
            <h4>الصفحات</h4>
            <a href="index.html">الرئيسية</a>
            <a href="about_us.html">من نحن</a>
            <a href="blog.html">المدونة</a>
            <a href="products.html">المنتجات</a>
            <a href="contact.html" class="active">اتصل بنا</a>
        </div>
        
        <hr>

        <div class="sidebar-section">
            <h4>الحساب والأدوات</h4>
            <a href="#"><i class="fa-regular fa-user"></i> تسجيل الدخول</a>
            <a href="#"><i class="fa-solid fa-gift"></i> الهدايا</a>
            <a href="#" class="mobile-cart-trigger"><i class="fa-solid fa-bag-shopping"></i> عربة التسوق</a>
        </div>
    </aside>

    <main>
        <section class="contact-intro">
            <div class="contact-container">
                <div class="contact-image">
                    <img src="assets/images/5.png" alt="منتجات عضوية">
                </div>

                <div class="contact-info">
                    <h1 class="section-title">تواصل معنا</h1>
                    
                    <div class="info-grid">
                        <div class="info-card">
                            <div class="card-icon"><i class="fa-regular fa-clock"></i></div>
                            <h3>ساعات العمل</h3>
                            <p>الإثنين - الجمعة: 8ص - 8م</p>
                            <p>السبت: 9ص - 7م</p>
                            <p>الأحد: 9ص - 8م</p>
                        </div>

                        <div class="info-card">
                            <div class="card-icon"><i class="fa-solid fa-location-dot"></i></div>
                            <h3>العنوان</h3>
                            <p>فشلوم</p>
                            <p>مقابل إشارة المرور - طرابلس</p>
                        </div>
                    </div>

                    <div class="email-card">
                        <i class="fa-regular fa-envelope"></i>
                        <span>البريد الإلكتروني: </span>
                        <a href="mailto:malikmamlok23@gmail.com" class="email-link">malikmamlok23@gmail.com</a>
                    </div>
                </div>
            </div>
        </section>

        <hr style="border: none; height: 1px; background-color: #246d44; opacity: 0.2; width: 80%; margin: 0 auto;">

        <section class="contact-form-section">
            <div class="form-container">
                <h2 class="form-title">ابقَ على اتصال</h2>
                <p class="form-subtitle">إذا كانت لديك أسئلة أو استفسارات خاصة، يسعدنا تواصلك معنا أو ملء هذا النموذج</p>

                <form action="#" class="contact-form">
                    <div class="input-row">
                        <div class="input-group">
                            <label>الاسم الأول *</label>
                            <input type="text" required placeholder="">
                        </div>
                        <div class="input-group">
                            <label>الاسم الأخير *</label>
                            <input type="text" required placeholder="">
                        </div>
                    </div>

                    <div class="input-row">
                        <div class="input-group">
                            <label>البريد الإلكتروني *</label>
                            <input type="email" required placeholder="example@mail.com">
                        </div>
                        <div class="input-group">
                            <label>رقم الهاتف</label>
                            <input type="tel" placeholder="09XXXXXXXX">
                        </div>
                    </div>

                    <div class="input-group full-width">
                        <label>اترك رسالتك هنا...</label>
                        <textarea rows="6" placeholder="كيف يمكننا مساعدتك؟"></textarea>
                    </div>

                    <div class="form-submit">
                        <button type="submit" class="submit-btn">إرسال</button>
                    </div>
                </form>
            </div>
        </section>

        <div class="cart-overlay" id="cart-overlay"></div>

        <aside class="cart-sidebar" id="cart-sidebar">
            <div class="cart-header">
                <h3>عربة التسوق</h3>
                <span class="close-cart" id="close-cart">&times;</span>
            </div>
            <div class="cart-body" id="cart-items-container">
                </div>
            <div class="cart-footer">
                <div class="cart-total-row">
                    <span>المجموع الكلي:</span>
                    <span id="cart-total-amount">0.00 د.ل</span>
                </div>
                <button class="checkout-btn">إتمام الشراء</button>
            </div>
        </aside>

        <div id="cart-toast" class="cart-toast">تم إضافة المنتج إلى السلة بنجاح!</div>
    </main>


    <footer class="main-footer">
        <div class="footer-container">
            <div class="footer-logo">
                <img src="assets/images/Logo.png" alt="M-Farmacy Logo">
            </div>
            <div class="footer-socials">
                <a href="#"><i class="fa-brands fa-facebook-f"></i></a>
                <a href="#"><i class="fa-brands fa-instagram"></i></a>
                <a href="#"><i class="fa-brands fa-tiktok"></i></a>
            </div>
            <div class="footer-copyright">
                <p>&copy; 2025 إم-فارمسي. بواسطة: مالك مملوك, سفيان الخطابي. جميع الحقوق محفوظة.</p>
            </div>
        </div>
    </footer>
    
    <script>
        // --- 1. تعريف العناصر (Selections) ---
        const menuBtn = document.getElementById('mobile-menu-btn');
        const closeBtn = document.getElementById('close-btn');
        const sidebar = document.getElementById('sidebar'); 
        const cartSidebar = document.getElementById('cart-sidebar');
        const cartOverlay = document.getElementById('cart-overlay');
        const closeCart = document.getElementById('close-cart');
        const cartIcon = document.querySelector('.cart-icon');
        const mobileCartTrigger = document.querySelector('.mobile-cart-trigger');
        const cartToast = document.getElementById('cart-toast');

        // --- 2. تهيئة السلة (Initialize Cart) ---
        // استعادة البيانات من الذاكرة المحلية للمتصفح أو إنشاء مصفوفة فارغة
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        updateCartUI(); 

        // --- 3. الوظائف الأساسية (Core Functions) ---

        // فتح وإغلاق عربة التسوق الجانبية
        function toggleCart() {
            cartSidebar.classList.toggle('active');
            cartOverlay.classList.toggle('active');
            // منع التمرير في خلفية الصفحة عند فتح السلة
            document.body.style.overflow = cartSidebar.classList.contains('active') ? 'hidden' : 'auto';
        }

        // تحديث واجهة السلة وحفظ البيانات
        function updateCartUI() {
            const container = document.getElementById('cart-items-container');
            const totalDisplay = document.getElementById('cart-total-amount');
            
            if (!container || !totalDisplay) return;

            container.innerHTML = '';
            let total = 0;

            cart.forEach((item, index) => {
                total += item.price * item.quantity;
                container.innerHTML += `
                    <div class="cart-item">
                        <img src="${item.image}" alt="${item.name}">
                        <div class="item-details">
                            <h4>${item.name}</h4>
                            <p class="item-price">${item.price.toFixed(2)} د.ل</p>
                            <div class="quantity-controls">
                                <button onclick="changeQty(${index}, -1)" class="qty-btn">-</button>
                                <input type="number" value="${item.quantity}" readonly>
                                <button onclick="changeQty(${index}, 1)" class="qty-btn">+</button>
                            </div>
                        </div>
                        <button onclick="removeFromCart(${index})" class="remove-item">
                            <i class="fa-solid fa-trash"></i>
                        </button>
                    </div>`;
            });

            totalDisplay.innerText = total.toFixed(2) + " د.ل";
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // تغيير الكمية (زيادة أو نقصان)
        window.changeQty = function(index, delta) {
            if (cart[index].quantity + delta > 0) {
                cart[index].quantity += delta;
                updateCartUI();
            }
        };

        // حذف منتج من السلة
        window.removeFromCart = function(index) {
            cart.splice(index, 1);
            updateCartUI();
        };

        // --- 4. مستمعات الأحداث (Event Listeners) ---

        // التحكم في قائمة الموبايل
        menuBtn.addEventListener('click', () => sidebar.classList.add('active'));
        closeBtn.addEventListener('click', () => sidebar.classList.remove('active'));

        // التحكم في ظهور وإخفاء السلة
        if(cartIcon) cartIcon.addEventListener('click', (e) => { e.preventDefault(); toggleCart(); });
        if(closeCart) closeCart.onclick = toggleCart;
        if(cartOverlay) cartOverlay.onclick = toggleCart;

        // فتح السلة من داخل قائمة الموبايل
        if (mobileCartTrigger) {
            mobileCartTrigger.addEventListener('click', (e) => {
                e.preventDefault();
                sidebar.classList.remove('active'); 
                toggleCart(); 
            });
        }

        // منطق "إضافة إلى السلة" للمنتجات المعروضة
        document.querySelectorAll('.add-to-cart').forEach((btn) => {
            btn.addEventListener('click', () => {
                const card = btn.closest('.product-card');
                const name = card.querySelector('h4').innerText;
                const priceText = card.querySelector('.price').innerText;
                // استخلاص الرقم فقط من نص السعر
                const price = parseFloat(priceText.replace(/[^\d.]/g, ''));
                const image = card.querySelector('img').src;

                const existing = cart.find(item => item.name === name);
                if (existing) {
                    existing.quantity += 1;
                } else {
                    cart.push({ name, price, image, quantity: 1 });
                }

                // إظهار إشعار النجاح (Toast) لمدة 3 ثوانٍ
                if(cartToast) {
                    cartToast.classList.add('show');
                    setTimeout(() => cartToast.classList.remove('show'), 3000);
                }

                updateCartUI();
            });
        });

        // الانتقال لصفحة إتمام الشراء
        const checkoutBtn = document.querySelector('.checkout-btn');
        if(checkoutBtn) {
            checkoutBtn.addEventListener('click', () => {
                if (cart.length === 0) {
                    alert("سلتك فارغة!");
                    return;
                }
                window.location.href = 'checkout.html';
            });
        }
    </script>

</body>
</html>